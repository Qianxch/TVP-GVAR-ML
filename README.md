# TVP-GVAR-ML

This repository contains the code and data for a research project that implements a **Time-Varying Parameter Global Vector Autoregressive (TVP-GVAR) model integrated with machine learning methods**.  
The framework is designed for macroeconomic interpretation, simulation, and forecasting under structural instability.

The repository includes scripts for:
- simulation-based data generation,
- empirical estimation and forecasting,
- visualization of time-varying parameters and impulse responses,
- and multivariate orthogonal impulse response analysis.

---

## Repository structure
TVP-GVAR-ML/
├── code/
│ ├── sim_tvp_gvar.ipynb
│ ├── forecast_and_simulation.ipynb
│ ├── tvp_gvar_plots.ipynb
│ └── joint_oirf_analysis.ipynb
├── data/
│ └── macro_panel.xlsx
├── results/
└── README.md

### Code description

- **sim_tvp_gvar.ipynb**  
  Generates simulated macroeconomic data under different parameter-drift scenarios.  
  This notebook is used as the data-generating process for the simulation and forecasting experiments and serves as a prerequisite for the simulation-based forecasting analysis.

- **forecast_and_simulation.ipynb**  
  Implements the forecasting framework based on the TVP-GVAR model.  
  It evaluates multiple forecasting methods using either simulated data or real data.  
  The variable `USE_SIM` controls the data source:  
  - `USE_SIM = True`: use simulated data generated by `sim_tvp_gvar.ipynb`;  
  - `USE_SIM = False`: use real macroeconomic data.

- **tvp_gvar_plots.ipynb**  
  Constructs the theoretical TVP-GVAR framework and visualizes key model components, including:
  - time-varying intercepts,
  - time-invariant intercepts,
  - time-varying coefficients,
  - time-invariant impulse response functions (OIRFs),
  - and time-varying impulse response functions (TVP-OIRFs).

- **joint_oirf_analysis.ipynb**  
  Conducts multivariate and joint-shock orthogonal impulse response analysis, focusing on cross-variable and cross-country transmission mechanisms.

---

## Data description

The `data/` directory contains the macroeconomic data required to run the empirical analysis.

- **Countries**: United States, Japan, Euro area  
- **Frequency**: monthly  
- **Variables**:
  - Gross Domestic Product (GDP)
  - Consumer Price Index (CPI)
  - Unemployment Rate (HUR)
  - West Texas Intermediate (WTI) crude oil price

GDP data are originally available at the quarterly frequency and are converted to monthly series using interpolation.  
CPI, unemployment, and oil price data are obtained at the monthly frequency.

### Data sources

- CPI: https://data.oecd.org/price/inflation-cpi.htm  
- GDP: https://data.oecd.org/gdp/quarterly-gdp.htm  
- Unemployment rate:  
  https://www.oecd.org/sdd/labour-stats/unemployment-rates-oecd-update-october-2021.htm  
- WTI oil price: https://fred.stlouisfed.org/series/MCOILWTICO  

All variables are preprocessed (log-differenced or differenced where appropriate) prior to estimation.

The `results/` directory stores figures and tables generated by the scripts.

---

## How to run

1. Download the repository as a ZIP file from GitHub and extract it locally.

2. Open the notebooks in the `code/` directory using Jupyter Notebook or Jupyter Lab.

3. No GPU is required; all scripts can be executed on a standard CPU environment.

4. Recommended execution order:
   - `sim_tvp_gvar.ipynb`  
     (required when running simulation-based forecasting)
   - `forecast_and_simulation.ipynb`
   - `tvp_gvar_plots.ipynb`
   - `joint_oirf_analysis.ipynb`

The notebooks `tvp_gvar_plots.ipynb` and `joint_oirf_analysis.ipynb` can be run independently.  
The notebook `forecast_and_simulation.ipynb` depends on `sim_tvp_gvar.ipynb` when `USE_SIM = True`.

---

## Outputs

The code produces the following outputs:

- time-varying intercepts and time-invariant intercepts,
- time-varying coefficients,
- time-invariant and time-varying impulse response functions (OIRFs and TVP-OIRFs),
- multivariate and joint-shock OIRFs,
- comparison plots of predicted versus observed values for ten macroeconomic variables,
- boxplots of forecasting errors across models under four simulation scenarios.

All outputs are saved in the `results/` directory.

---

## Notes and limitations

- Simulation and machine learning components involve randomness; although random seeds are set where possible, small numerical differences may arise across runs.
- The TVP-GVAR framework models smooth parameter evolution and does not explicitly account for discrete regime-switching behavior.
- Forecasting results may be sensitive to hyperparameter choices and smoothing settings.
- The code is intended for academic research and replication purposes rather than production use.

---

## Reference

This repository accompanies a research paper on TVP-GVAR models with machine learning–based forecasting.  
Further details will be provided upon publication.
